name: cloudfoundry


on:
  push:
    branches:
      - 'master'
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Set up JDK 11
        uses: actions/setup-java@v1
        with:
          java-version: 11
      - name: Build with Maven
        run: mvn -B clean package -DskipTests
      - name: Login to cloudfoundry
        uses: comsysto/cloudfoundry-action/auth@v1.0
        with:
          api: https://api.run.pivotal.io
          user: lyegeniy@googlemail.com
          password: 8BMUVjC.v.nH&uH
      - name: Switch to cf org and space
        uses: comsysto/cloudfoundry-action/cli@v1.0
        with:
          args: target -o Honeybadger -s development
      - name: cf push
        uses: comsysto/cloudfoundry-action/cli@v1.0
        with:
          args: push -f manifest.yml -p ./target/realtimescheduler-0.0.1-SNAPSHOT.jar